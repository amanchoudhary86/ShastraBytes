{% extends 'base.html' %} 
{% block title %}Dashboard | ShastraBytes{% endblock %}
{% block content %}
<link rel="stylesheet" href="/static/css/dashboard.css" />
<div class="container dashboard mt-5">
  <div class="row">
    <div class="col-12 text-center mb-4">
      <h1 class="dashboard-heading">
        Welcome back, {{ user_name or 'User' }}!
      </h1>
      <p class="dashboard-subtitle">
        Here's your personalized career dashboard.
      </p>
    </div>
  </div>

  <!-- Progress Bar Section -->
  <div class="progress-section mt-4 mb-4">
    <div class="row justify-content-center">
      <div class="col-md-8">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <span class="progress-label">Profile Completion</span>
          <span class="progress-percentage">{{ profile_completion }}%</span>
        </div>
        <div class="progress" style="height: 8px; border-radius: 10px;">
          <div 
            class="progress-bar bg-primary" 
            role="progressbar" 
            style="width: {{ profile_completion }}%; border-radius: 10px;" 
            aria-valuenow="{{ profile_completion }}" 
            aria-valuemin="0" 
            aria-valuemax="100">
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Test Results Section -->
  {% if latest_test_result %}
  <div class="test-results-section mb-4">
    <div class="row justify-content-center">
      <div class="col-md-8">
        <div class="card shadow-sm">
          <div class="card-header bg-success text-white">
            <h5 class="mb-0">Latest Test Results</h5>
            <small>Taken on {{ latest_test_result.test_date }}</small>
          </div>
          <div class="card-body">
            <div class="row text-center">
              <div class="col-md-3">
                <div class="test-score-item">
                  <h6>Overall Score</h6>
                  <div class="score-display">{{ latest_test_result.total_score }}/20</div>
                  <div class="percentage-display">{{ "%.1f"|format(latest_test_result.percentage) }}%</div>
                </div>
              </div>
              <div class="col-md-3">
                <div class="test-score-item">
                  <h6>Python</h6>
                  <div class="score-display">{{ latest_test_result.python_score }}/10</div>
                  <div class="percentage-display">{{ "%.1f"|format((latest_test_result.python_score/10)*100) }}%</div>
                </div>
              </div>
              <div class="col-md-3">
                <div class="test-score-item">
                  <h6>C++</h6>
                  <div class="score-display">{{ latest_test_result.cpp_score }}/10</div>
                  <div class="percentage-display">{{ "%.1f"|format((latest_test_result.cpp_score/10)*100) }}%</div>
                </div>
              </div>
              <div class="col-md-3">
                <div class="test-score-item">
                  <a href="{{ url_for('test_result', 
                                      python_score=latest_test_result.python_score,
                                      cpp_score=latest_test_result.cpp_score,
                                      total_score=latest_test_result.total_score,
                                      percentage=latest_test_result.percentage) }}" 
                     class="btn btn-outline-primary btn-sm">
                    View Details
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endif %}
  
  <!-- Action Buttons -->
  <div class="action-buttons mb-4">
    <div class="row justify-content-center">
      <div class="col-md-6">
        <div class="btn-group-custom">
          {% if profile_completion < 100 %}
            <a href="{{ url_for('questionnaire') }}" class="btn btn-primary btn-lg me-3">
              Complete Profile
            </a>
            <button class="btn btn-secondary btn-lg" disabled>
              Begin Test
            </button>
          {% else %}
            <a href="{{ url_for('questionnaire') }}" class="btn btn-outline-primary btn-lg me-3">
              Update Profile
            </a>
            <a href="{{ url_for('test') }}" class="btn btn-success btn-lg">
              Begin Test
            </a>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <div class="row dashboard-cards">
    <div class="col-md-4 mb-4">
      <div class="card card-feature shadow-sm">
        <div class="card-body text-center">
          <h5 class="card-title">Roadmap</h5>
          <p class="card-text">
            View and follow your AI-powered career roadmap.
          </p>
          <a href="#" class="btn btn-outline-primary btn-sm">View Roadmap</a>
        </div>
      </div>
    </div>
    <div class="col-md-4 mb-4">
      <div class="card card-feature shadow-sm">
        <div class="card-body text-center">
          <h5 class="card-title">Interview Prep</h5>
          <p class="card-text">
            Practice mock interviews and coding questions.
          </p>
          <a href="#" class="btn btn-outline-primary btn-sm">Start Practice</a>
        </div>
      </div>
    </div>
    <div class="col-md-4 mb-4">
      <div class="card card-feature shadow-sm">
        <div class="card-body text-center">
          <h5 class="card-title">Skill Tracker</h5>
          <p class="card-text">Track your progress and upcoming goals.</p>
          <a href="#" class="btn btn-outline-primary btn-sm">View Progress</a>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.test-results-section {
  margin-bottom: 2rem;
}

.test-score-item {
  padding: 1rem;
  border-radius: 8px;
  background-color: #f8f9fa;
  margin-bottom: 1rem;
}

.test-score-item h6 {
  color: #6c757d;
  font-size: 0.9rem;
  margin-bottom: 0.5rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.score-display {
  font-size: 1.5rem;
  font-weight: bold;
  color: #212529;
  margin-bottom: 0.25rem;
}

.percentage-display {
  font-size: 1rem;
  color: #6c757d;
}

.btn-group-custom {
  text-align: center;
}

.btn-group-custom .btn {
  margin: 0 0.5rem;
}

/* Responsive design for test results */
@media (max-width: 768px) {
  .test-score-item {
    margin-bottom: 1rem;
  }
  
  .score-display {
    font-size: 1.2rem;
  }
  
  .btn-group-custom .btn {
    display: block;
    margin: 0.5rem 0;
    width: 100%;
  }
}
</style>
{% endblock %}